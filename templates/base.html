{% load i18n %}
<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}kartopu.money{% endblock %}</title>
    {% block head %}{% endblock %}
  </head>

  <body>
    <header style="border-bottom: 1px solid #ddd; padding: 1rem 0;">
      {% include "includes/navbar.html" %}
    </header>

    {% if messages %}
      <div style="max-width: 1100px; margin: 1rem auto 0; padding: 0 1rem;">
        {% for message in messages %}
          <div style="padding: 0.75rem 1rem; border: 1px solid #eee; margin-bottom: 0.5rem;">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <div
      style="
        max-width: 1100px;
        margin: 0 auto;
        padding: 1rem;
        display: grid;
        grid-template-columns: 1fr 280px;
        gap: 2rem;
      "
    >
      <main>
        {% block content %}{% endblock %}
      </main>

      <aside>
        {% include "includes/sidebar.html" %}
      </aside>
    </div>

    <footer style="border-top: 1px solid #ddd; padding: 1rem 0; margin-top: 2rem;">
      <div style="max-width: 1100px; margin: 0 auto; padding: 0 1rem;">
        <small>Â© {% now "Y" %} kartopu.money</small>
      </div>
    </footer>
  </body>
  <script>
  {% block js_script %}{% endblock %}
  (function () {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get("popup") === "1") {
        if (window.opener) {
          window.opener.postMessage("social-auth:complete", "*");
        }
        try {
          localStorage.setItem("social-auth-complete", String(Date.now()));
        } catch (error) {
          console.warn("Unable to write social-auth-complete marker.", error);
        }
        window.setTimeout(() => {
          window.close();
        }, 150);
      }
    })();
  </script>
</html>
