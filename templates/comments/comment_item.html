<li class="comment-item">
  <div class="comment-header">
    {% with local_avatar=comment.author.avatar_rendition %}
      {% if local_avatar %}
        <img
          class="comment-avatar"
          src="{{ local_avatar.src }}"
          srcset="{{ local_avatar.srcset }}"
          alt="{{ comment.author.full_name }}"
          loading="lazy"
          width="48"
          height="48"
          decoding="async"
        >
      {% elif comment.social_avatar_url %}
        <img
          class="comment-avatar"
          src="{{ comment.social_avatar_url }}"
          alt="{{ comment.author.full_name }}"
          loading="lazy"
          width="48"
          height="48"
          decoding="async"
        >
      {% endif %}
    {% endwith %}
    <div class="comment-meta">
      <strong>{{ comment.author.full_name }}</strong>
      <small>— {{ comment.created_at|date:"d F Y H:i" }}</small>
      {% if is_staff %}
        <span style="font-size: 0.8em; margin-left: 10px; color: {% if comment.status == 'approved' %}green{% elif comment.status == 'pending' %}orange{% else %}red{% endif %};">
          [{{ comment.get_status_display }}]
        </span>
      {% endif %}
    </div>
  </div>
  <p class="comment-body">{{ comment.body|linebreaksbr }}</p>

  {% if is_staff %}
    <div class="comment-moderation" style="margin-bottom: 10px;">
      <form method="post" action="{% url 'comments:moderate_comment' comment.id %}" style="display:inline;">
        {% csrf_token %}
        {% if comment.status != 'approved' %}
          <button type="submit" name="action" value="approve" class="button button--small" style="padding: 2px 8px; font-size: 0.8em;">Onayla</button>
        {% endif %}
        {% if comment.status != 'pending' %}
          <button type="submit" name="action" value="pending" class="button button--small" style="padding: 2px 8px; font-size: 0.8em;">Onaya Al</button>
        {% endif %}
        <button type="submit" name="action" value="delete" class="button button--small" style="padding: 2px 8px; font-size: 0.8em; color: red; border-color: red;" onclick="return confirm('Silmek istediğinize emin misiniz?');">Sil</button>
      </form>
    </div>
  {% endif %}

  {% if site_settings.is_comments_enabled and can_comment %}
    <details class="comment-reply">
      <summary class="comment-reply__toggle">Yanıtla</summary>
      <form method="post" action="{% url 'comments:post_comment' comment.post_id %}">
        {% csrf_token %}
        <input type="hidden" name="parent_id" value="{{ comment.id }}">
        <input type="text" name="website" autocomplete="url" class="input-field website_" id="id_website" value="">
        <div class="comment-reply__field">
          <textarea
            name="body"
            rows="3"
            placeholder="Yanıtınızı yazın...(Maksimum 3000 karakter)"
            required
          ></textarea>
        </div>
        <button type="submit" class="button button--primary">Yanıtı Gönder</button>
      </form>
    </details>
  {% endif %}

  {% if comment.nested_replies %}
    <ul class="comment-children">
      {% for reply in comment.nested_replies %}
        {% include "comments/comment_item.html" with comment=reply can_comment=can_comment is_staff=is_staff %}
      {% endfor %}
    </ul>
  {% endif %}
</li>
