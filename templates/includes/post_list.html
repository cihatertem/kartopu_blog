{% load static blog_extras %}

<ul class="post-list">
  {% for post in posts %}
    <li class="post-list__item">
      <h2 class="post-list__title">
        <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
      </h2>
      {% if post.cover_image %}
        {% with cover=post.cover_rendition %}
          {% if cover %}
            <figure>
              <img
                src="{{ cover.src }}"
                srcset="{{ cover.srcset }}"
                sizes="(max-width: 768px) 100vw, 720px"
                alt="{{ post.title }}"
                width="{{ cover.width }}"
                height="{{ cover.height }}"
                decoding="async"
                {% if forloop.first %}
                  loading="eager"
                  fetchpriority="high"
                {% else %}
                  loading="lazy"
                {% endif %}
              />
            </figure>
          {% else %}
            <figure class="home-portfolio__placeholder">
              <img
                src="{% static 'images/home/portfolio-coins.svg' %}"
                alt="Portföy görseli"
                width="600"
                height="600"
                loading="lazy"
                decoding="async"
              />
            </figure>
          {% endif %}
        {% endwith %}
      {% else %}
        <figure class="home-portfolio__placeholder">
          <img
            src="{% static 'images/home/portfolio-coins.svg' %}"
            alt="Portföy görseli"
            width="600"
            height="600"
            loading="lazy"
            decoding="async"
          />
        </figure>
      {% endif %}

      <div class="post-list__meta">
        <div class="post-list__author">
          <div class="post-list__avatar">
            {% with avatar=post.author.avatar_rendition %}
              {% if avatar %}
                <img
                  class="post-list__avatar-img"
                  src="{{ avatar.src }}"
                  srcset="{{ avatar.srcset }}"
                  sizes="42px"
                  width="42"
                  height="42"
                  alt="{{ post.author.full_name|default:post.author.email }}"
                  loading="lazy"
                  decoding="async"
                />
              {% else %}
                <span class="post-list__avatar-fallback" aria-hidden="true">
                  {{ post.author.full_name|default:post.author.email|slice:":1" }}
                </span>
              {% endif %}
            {% endwith %}
          </div>
          <div class="post-list__author-info">
            <span class="post-list__author-name">{{ post.author.full_name|default:post.author.email }}</span>
            <span class="post-list__meta-line">
              <span class="post-list__meta-dot" aria-hidden="true"></span>
              <span>{{ post.published_at|date:"d F Y" }}</span>
              {% if post.category %}
                <span class="post-list__meta-separator">•</span>
                <a  class="post-list__category-link" href="{{ post.category.get_absolute_url }}">{{ post.category.name }}</a>
              {% endif %}
            </span>
          </div>
        </div>
      </div>

      {% if post.excerpt %}
        <div class="post-list__excerpt">
          {{ post.excerpt|render_excerpt }}
          <p>
            <a class="post-list__continue-read" href="{{ post.get_absolute_url }}">
              Okumaya devam et...
            </a>
          </p>
        </div>
      {% endif %}
    </li>
    <hr />
  {% endfor %}
</ul>
